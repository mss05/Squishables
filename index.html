<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Squishables - Hands On, Screens Off</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Squishables Marka Renkleri (Logo Bazlƒ±) */
            --primary: #FFB7B2; /* Pastel Pembe */
            --secondary: #B5EAD7; /* Mint Ye≈üili */
            --accent: #FFDAC1; /* Pastel ≈ûeftali/Sarƒ± */
            --text: #6d6d6d;
            --dark: #555;
            --white: #ffffff;
            --danger: #ff8b94;
            --success: #97c1a9;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Quicksand', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background-color: #FFF9F9; color: var(--text); padding-bottom: 90px; user-select: none; }

        /* --- HEADER --- */
        header {
            background: white; 
            padding: 15px 20px;
            position: sticky; top: 0; z-index: 100; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            border-bottom: 5px solid var(--secondary);
        }
        .header-top { display: flex; justify-content: space-between; align-items: center; }
        .brand-logo { font-size: 1.5rem; font-weight: 800; color: var(--primary); letter-spacing: -0.5px; }
        .brand-slogan { font-size: 0.7rem; color: var(--secondary); font-weight: bold; text-transform: uppercase; letter-spacing: 1px; }
        
        .balance-badge { 
            background: var(--accent); color: var(--dark); 
            padding: 5px 12px; border-radius: 20px; font-size: 0.8rem; font-weight: bold;
            display: flex; align-items: center; gap: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        /* --- PROGRESS BAR (SADAKAT) --- */
        .progress-area { background: white; padding: 15px; margin: 15px; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.03); }
        .progress-track { background: #f0f0f0; height: 12px; border-radius: 10px; margin: 8px 0; overflow: hidden; }
        .progress-fill { background: linear-gradient(90deg, var(--secondary), var(--primary)); height: 100%; width: 0%; transition: width 0.5s; border-radius: 10px; }

        /* --- PRODUCT CARDS (MoodMakers) --- */
        .market-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; padding: 0 15px; }
        .product-card { 
            background: white; border-radius: 20px; overflow: hidden; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.05); display: flex; flex-direction: column; 
            transition: transform 0.2s; border: 2px solid transparent;
        }
        .product-card:active { transform: scale(0.98); }
        .product-img { 
            height: 130px; background: #FFF5F5; display: flex; align-items: center; justify-content: center; font-size: 3.5rem; 
            position: relative;
        }
        .new-badge { position: absolute; top: 10px; right: 10px; background: var(--secondary); color: white; font-size: 0.6rem; padding: 3px 8px; border-radius: 10px; font-weight: bold; }
        
        .product-info { padding: 12px; flex-grow: 1; display: flex; flex-direction: column; justify-content: space-between; }
        .add-btn { 
            background: var(--primary); color: white; padding: 8px; border-radius: 12px; 
            cursor: pointer; margin-top: 8px; font-weight: bold; border: none; width: 100%;
            box-shadow: 0 3px 10px rgba(255, 183, 178, 0.4);
        }

        /* --- ORDER TIMER (Simulation) --- */
        #orderTimerAlert {
            position: fixed; top: 85px; left: 50%; transform: translateX(-50%);
            width: 90%; background: white; padding: 15px; border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15); z-index: 101;
            border-left: 6px solid var(--primary); display: none;
        }
        .timer-bar { height: 6px; background: #eee; margin: 10px 0; border-radius: 3px; overflow: hidden; }
        .timer-fill { height: 100%; background: var(--danger); width: 100%; transition: width linear; }

        /* --- SECTIONS --- */
        .section { display: none; animation: fadeIn 0.4s; }
        .section.active { display: block; }
        
        /* --- GAME UI --- */
        #gameSection { height: calc(100vh - 160px); position: relative; margin: 15px; border-radius: 20px; overflow: hidden; box-shadow: 0 5px 20px rgba(0,0,0,0.1); }
        #gameOverlay { 
            position: absolute; top:0; left:0; width:100%; height:100%; 
            background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(5px);
            display: flex; flex-direction: column; justify-content: center; align-items: center; 
            z-index: 10; text-align: center; padding: 20px;
        }

        /* --- BOTTOM NAV --- */
        .nav-bar {
            position: fixed; bottom: 20px; left: 20px; right: 20px;
            background: white; border-radius: 25px;
            display: flex; justify-content: space-around; padding: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1); z-index: 100;
        }
        .nav-item { text-align: center; color: #ccc; font-size: 0.7rem; display: flex; flex-direction: column; align-items: center; gap: 4px; transition: 0.3s; }
        .nav-item i { font-size: 1.4rem; }
        .nav-item.active { color: var(--primary); transform: translateY(-5px); }

        /* --- CART MODAL --- */
        .modal { position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); z-index:200; display:none; align-items:end; }
        .modal-content { background: white; width: 100%; border-radius: 30px 30px 0 0; padding: 25px; animation: slideUp 0.3s; max-height: 80vh; overflow-y: auto; }

        /* --- WHEEL --- */
        .wheel-container { position: relative; width: 280px; height: 280px; margin: 20px auto; }
        .wheel { width: 100%; height: 100%; border-radius: 50%; border: 8px solid white; transition: transform 4s cubic-bezier(0.25, 0.1, 0.25, 1); background: conic-gradient(var(--primary) 0deg 90deg, var(--secondary) 90deg 180deg, var(--accent) 180deg 270deg, #E0BBE4 270deg 360deg); box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <header>
        <div class="header-top">
            <div>
                <div class="brand-logo">Squishables</div>
                <div class="brand-slogan">Hands On, Screens Off.</div>
            </div>
            <div style="display:flex; gap:8px;">
                <div class="balance-badge"><i class="fas fa-star" style="color:#ffa502"></i> <span id="pointDisplay">0</span></div>
                <div class="balance-badge"><i class="fas fa-ticket-alt" style="color:#ff6b81"></i> <span id="spinDisplay">0</span></div>
            </div>
        </div>
    </header>

    <div id="orderTimerAlert">
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <strong>‚è≥ Sipari≈ü Hazƒ±rlanƒ±yor...</strong>
            <span id="timerCount" style="color:var(--danger); font-weight:800;">5s</span>
        </div>
        <div class="timer-bar"><div class="timer-fill" id="timerFill"></div></div>
        <p style="font-size:0.8rem; color:#888; margin-bottom:10px;">ƒ∞ptal edersen puan kazanamazsƒ±n!</p>
        <button onclick="app.cancelActiveOrder()" style="width:100%; background:var(--danger); color:white; border:none; padding:10px; border-radius:10px; font-weight:bold;">ƒ∞PTAL ET</button>
    </div>

    <div class="progress-area">
        <div style="display:flex; justify-content:space-between; font-size:0.8rem; margin-bottom:5px;">
            <span style="font-weight:bold; color:var(--dark);">Ekran Diyeti Barajƒ±</span>
            <span id="progressText" style="color:var(--primary);">0 / 500 Puan</span>
        </div>
        <div class="progress-track">
            <div class="progress-fill" id="progressBar"></div>
        </div>
        <small style="color:#999; font-size:0.7rem;">Baraj dolunca 1 √áark Hakkƒ± kazanƒ±rsƒ±n!</small>
    </div>

    <div id="market" class="section active">
        <h3 style="padding: 0 20px; margin-bottom:15px; color:var(--dark);">Duyusal √úr√ºnlerimiz</h3>
        <div class="market-grid" id="productGrid">
            </div>
        <div onclick="app.openCart()" style="position: fixed; bottom: 110px; right: 20px; background: var(--dark); color: white; padding: 15px 20px; border-radius: 50px; box-shadow: 0 5px 20px rgba(0,0,0,0.2); display: flex; align-items: center; gap: 10px; cursor: pointer; z-index: 90; font-weight:bold;">
            <i class="fas fa-shopping-basket"></i>
            <span id="cartTotalDisplay">0 TL</span>
        </div>
    </div>

    <div id="wheelSection" class="section">
        <div style="text-align: center; padding: 40px 20px;">
            <h2 style="color:var(--primary);">≈ûans √áarkƒ±</h2>
            <p style="color:#888; margin-bottom:20px;">Kalan Hakkƒ±n: <strong id="wheelRightText" style="font-size:1.2rem; color:var(--dark);">0</strong></p>
            
            <div class="wheel-container">
                <div style="position: absolute; top: -15px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 15px solid transparent; border-right: 15px solid transparent; border-top: 25px solid var(--dark); z-index: 2;"></div>
                <div class="wheel" id="spinWheel"></div>
                <button onclick="app.spin()" style="position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); width:70px; height:70px; border-radius:50%; border:none; background:white; font-weight:bold; color:var(--primary); box-shadow:0 5px 15px rgba(0,0,0,0.1); font-size:1rem;">√áEVƒ∞R</button>
            </div>
            <div style="background: #fff; padding:15px; border-radius:15px; margin-top:20px; font-size:0.9rem; color:#666;">
                üéÅ √ñd√ºller: Bedava Hamur, %20 ƒ∞ndirim, Aktivite Kartƒ±
            </div>
        </div>
    </div>

    <div id="gameSection" class="section">
        <div id="gameOverlay">
            <div style="font-size:4rem; margin-bottom:10px;">üåà</div>
            <h2 style="color:var(--dark); margin-bottom:10px;">Ekran Dedektifi</h2>
            <p style="color:#666; margin-bottom:20px; line-height:1.5;">Hamurlarƒ± ve boyalarƒ± topla, <br>Tablet ve telefonlardan ka√ß! <br><br><strong>Hedef: Screens Off!</strong></p>
            <p style="margin-bottom:20px;">Oyun Hakkƒ±n: <span id="gameRightText" style="font-weight:bold; color:var(--primary);">0</span></p>
            <button onclick="game.init()" style="padding:15px 40px; background:var(--primary); color:white; border:none; border-radius:30px; font-size:1.1rem; font-weight:bold; box-shadow: 0 5px 15px rgba(255, 183, 178, 0.5);">OYNA</button>
        </div>
        <canvas id="gameCanvas"></canvas>
    </div>

    <div id="ordersSection" class="section">
        <div style="padding:20px;">
            <h3>Sipari≈ü Ge√ßmi≈üim</h3>
            <p style="font-size:0.8rem; color:#999; margin-bottom:15px;">Sipari≈üini iade edersen, kazandƒ±ƒüƒ±n puanlar silinir.</p>
            <div id="orderList"></div>
        </div>
    </div>

    <div id="cartModal" class="modal">
        <div class="modal-content">
            <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
                <h3>Sepetim</h3>
                <span onclick="app.closeCart()" style="cursor:pointer; font-size:1.5rem;">&times;</span>
            </div>
            <div id="cartItems" style="margin-bottom:25px;"></div>
            <button onclick="app.startCheckout()" style="width:100%; background:var(--secondary); color:#3c6e58; padding:18px; border:none; border-radius:15px; font-size:1.1rem; font-weight:bold;">
                Sƒ∞PARƒ∞≈ûƒ∞ TAMAMLA (<span id="cartFinalTotal">0</span> TL)
            </button>
        </div>
    </div>

    <nav class="nav-bar">
        <div class="nav-item active" onclick="app.switchTab('market', this)"><i class="fas fa-store-alt"></i>Market</div>
        <div class="nav-item" onclick="app.switchTab('wheelSection', this)"><i class="fas fa-dharmachakra"></i>√áark</div>
        <div class="nav-item" onclick="app.switchTab('gameSection', this)"><i class="fas fa-gamepad"></i>Oyun</div>
        <div class="nav-item" onclick="app.switchTab('ordersSection', this)"><i class="fas fa-receipt"></i>Sipari≈üler</div>
    </nav>

    <script>
        // --- DATA: SQUISHABLES √úR√úNLERƒ∞ ---
        const PRODUCTS = [
            { id: 1, name: 'MoodMakers Box', price: 850, icon: 'üéÅ', isNew: true },
            { id: 2, name: 'Organik Hamur (4\'l√º)', price: 350, icon: 'üé®', isNew: false },
            { id: 3, name: 'Sihirli Boya Seti', price: 280, icon: 'üñåÔ∏è', isNew: false },
            { id: 4, name: 'Duyusal Ara√ßlar', price: 150, icon: 'ü™µ', isNew: false },
            { id: 5, name: 'Aktivite Kartlarƒ±', price: 120, icon: 'üÉè', isNew: false },
            { id: 6, name: 'Aslƒ± Enver √ñzel Set', price: 950, icon: '‚ú®', isNew: true }
        ];

        // --- APP LOGIC ---
        const app = {
            state: {
                points: 0,
                spinRights: 1, // Ho≈ügeldin hediyesi
                gameRights: 2,
                currentProgress: 0,
                threshold: 1500, // 1500 TL'de bir √ßark
                cart: [],
                orders: []
            },
            
            activeOrderTimeout: null,
            activeOrder: null,

            init: function() {
                this.loadState();
                this.renderMarket();
                this.updateUI();
            },

            saveState: function() {
                localStorage.setItem('squishState', JSON.stringify(this.state));
                this.updateUI();
            },
            loadState: function() {
                const saved = localStorage.getItem('squishState');
                if(saved) this.state = JSON.parse(saved);
            },

            // MARKET & CART
            renderMarket: function() {
                const grid = document.getElementById('productGrid');
                grid.innerHTML = PRODUCTS.map(p => `
                    <div class="product-card">
                        <div class="product-img">
                            ${p.icon}
                            ${p.isNew ? '<span class="new-badge">YENƒ∞</span>' : ''}
                        </div>
                        <div class="product-info">
                            <div>
                                <strong style="color:var(--dark);">${p.name}</strong>
                                <div style="color:var(--text); font-size:0.9rem;">${p.price} TL</div>
                            </div>
                            <button class="add-btn" onclick="app.addToCart(${p.id})">Sepete Ekle</button>
                        </div>
                    </div>
                `).join('');
            },

            addToCart: function(id) {
                const product = PRODUCTS.find(p => p.id === id);
                this.state.cart.push(product);
                this.updateCartUI();
            },

            updateCartUI: function() {
                const total = this.state.cart.reduce((sum, item) => sum + item.price, 0);
                document.getElementById('cartTotalDisplay').innerText = total + " TL";
                document.getElementById('cartFinalTotal').innerText = total;
            },

            openCart: function() {
                const modal = document.getElementById('cartModal');
                const list = document.getElementById('cartItems');
                
                if(this.state.cart.length === 0) {
                    list.innerHTML = "<p style='text-align:center; color:#999;'>Sepetin bo≈ü. Hadi biraz duyusal oyun se√ßelim!</p>";
                } else {
                    list.innerHTML = this.state.cart.map((item, index) => `
                        <div style="display:flex; justify-content:space-between; padding:10px 0; border-bottom:1px solid #f0f0f0;">
                            <span>${item.icon} ${item.name}</span>
                            <span>${item.price} TL <i class="fas fa-trash" onclick="app.removeFromCart(${index})" style="color:var(--danger); margin-left:10px; cursor:pointer;"></i></span>
                        </div>
                    `).join('');
                }
                modal.style.display = 'flex';
            },

            removeFromCart: function(index) {
                this.state.cart.splice(index, 1);
                this.openCart(); 
                this.updateCartUI();
            },

            closeCart: function() {
                document.getElementById('cartModal').style.display = 'none';
            },

            // --- CHECKOUT & 5 SECOND RULE ---
            startCheckout: function() {
                const total = this.state.cart.reduce((sum, item) => sum + item.price, 0);
                if(total === 0) return;

                this.closeCart();
                
                this.activeOrder = {
                    id: Date.now(),
                    total: total,
                    items: [...this.state.cart],
                    date: new Date().toLocaleString(),
                    status: 'WAITING',
                    rewardsGiven: [] 
                };

                this.state.cart = [];
                this.updateCartUI();

                const alertBox = document.getElementById('orderTimerAlert');
                const fill = document.getElementById('timerFill');
                const countText = document.getElementById('timerCount');
                
                alertBox.style.display = 'block';
                fill.style.width = '100%';
                fill.style.transition = 'none'; 

                let timeLeft = 5;
                countText.innerText = timeLeft + "s";

                void fill.offsetWidth; 
                fill.style.transition = 'width 5s linear';
                fill.style.width = '0%';

                const interval = setInterval(() => {
                    timeLeft--;
                    countText.innerText = timeLeft + "s";
                    if(timeLeft <= 0) clearInterval(interval);
                }, 1000);

                this.activeOrderTimeout = setTimeout(() => {
                    this.finalizeOrder();
                    alertBox.style.display = 'none';
                }, 5000);
            },

            cancelActiveOrder: function() {
                if(this.activeOrderTimeout) {
                    clearTimeout(this.activeOrderTimeout);
                    this.activeOrderTimeout = null;
                }
                document.getElementById('orderTimerAlert').style.display = 'none';
                alert("Sipari≈ü ƒ∞ptal Edildi! Puan kazanƒ±lmadƒ±.");
                this.activeOrder = null;
            },

            finalizeOrder: function() {
                if(!this.activeOrder) return;

                const order = this.activeOrder;
                order.status = 'COMPLETED';

                const oldProgress = this.state.currentProgress;
                const totalNew = oldProgress + order.total;
                
                const rightsEarned = Math.floor(totalNew / this.state.threshold);
                const remaining = totalNew % this.state.threshold;

                if (rightsEarned > 0) {
                    this.state.spinRights += rightsEarned;
                    order.rewardsGiven.push({ type: 'SPIN', amount: rightsEarned });
                    alert(`üéâ Harika! MoodMakers yola √ßƒ±kƒ±yor! \n+${rightsEarned} √áark Hakkƒ± Kazandƒ±n!`);
                } else {
                    alert("‚úÖ Sipari≈ü Alƒ±ndƒ±! Duyusal oyun saati yakla≈üƒ±yor.");
                }

                this.state.currentProgress = remaining;
                this.state.orders.unshift(order);
                this.saveState();
                this.activeOrder = null;
            },

            returnOrder: function(orderId) {
                if(!confirm("Sipari≈üi iade edersen puanlarƒ±n silinir. Emin misin?")) return;

                const orderIndex = this.state.orders.findIndex(o => o.id === orderId);
                if(orderIndex === -1) return;

                const order = this.state.orders[orderIndex];

                if(order.rewardsGiven.length > 0) {
                    order.rewardsGiven.forEach(r => {
                        if(r.type === 'SPIN') {
                            this.state.spinRights -= r.amount;
                        }
                    });
                }
                
                order.status = 'RETURNED';
                this.saveState();
                this.renderOrders();
            },

            renderOrders: function() {
                const list = document.getElementById('orderList');
                list.innerHTML = this.state.orders.map(o => `
                    <div style="background:white; padding:15px; border-radius:15px; margin-bottom:10px; box-shadow:0 2px 5px rgba(0,0,0,0.05); border-left: 5px solid ${o.status === 'COMPLETED' ? 'var(--secondary)' : 'var(--danger)'};">
                        <div style="display:flex; justify-content:space-between;">
                            <strong>#${o.id.toString().slice(-4)}</strong>
                            <span>${o.total} TL</span>
                        </div>
                        <div style="font-size:0.8rem; color:#999;">${o.date}</div>
                        <div style="margin-top:8px;">
                            ${o.status === 'COMPLETED' 
                                ? `<span style="color:var(--secondary); font-weight:bold;">Teslim Edildi</span> ${o.rewardsGiven.length ? '<i class="fas fa-gift" style="color:var(--primary)"></i>' : ''} <button onclick="app.returnOrder(${o.id})" style="float:right; background:#FFF5F5; border:none; padding:5px 12px; border-radius:10px; cursor:pointer; color:var(--danger); font-size:0.8rem;">ƒ∞ade</button>` 
                                : `<span style="color:var(--danger)">ƒ∞ade Edildi</span>`
                            }
                        </div>
                    </div>
                `).join('');
            },

            spin: function() {
                if(this.state.spinRights < 1) {
                    alert("Hakkƒ±n kalmadƒ±! MoodMakers sipari≈üi vererek kazanabilirsin.");
                    return;
                }

                this.state.spinRights--;
                this.saveState();

                const wheel = document.getElementById('spinWheel');
                const deg = Math.floor(3000 + Math.random() * 360);
                wheel.style.transform = `rotate(${deg}deg)`;

                setTimeout(() => {
                    const rand = Math.random();
                    let msg = "";
                    if(rand < 0.5) {
                        this.state.gameRights++;
                        msg = "üéÆ Tebrikler! 1 Oyun Hakkƒ± Kazandƒ±n! Ekranlardan ka√ßmaya devam.";
                    } else {
                        this.state.points += 50;
                        msg = "‚≠ê Harika! 50 Ekran Diyeti Puanƒ± kazandƒ±n!";
                    }
                    this.saveState();
                    alert(msg);
                }, 4000);
            },

            updateUI: function() {
                document.getElementById('pointDisplay').innerText = this.state.points;
                document.getElementById('spinDisplay').innerText = this.state.spinRights;
                document.getElementById('wheelRightText').innerText = this.state.spinRights;
                document.getElementById('gameRightText').innerText = this.state.gameRights;
                
                const pct = (this.state.currentProgress / this.state.threshold) * 100;
                document.getElementById('progressBar').style.width = pct + '%';
                document.getElementById('progressText').innerText = `${this.state.currentProgress} / ${this.state.threshold}`;
            },

            switchTab: function(tabId, el) {
                document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
                document.getElementById(tabId).classList.add('active');
                document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
                el.classList.add('active');
                if(tabId === 'ordersSection') this.renderOrders();
            }
        };

        // --- GAME ENGINE: "SCREEN DETOX" ---
        const game = {
            active: false,
            score: 0,
            playerX: 0,
            items: [],
            init: function() {
                if(app.state.gameRights > 0) {
                    app.state.gameRights--;
                    app.saveState();
                    document.getElementById('gameOverlay').style.display = 'none';
                    this.active = true;
                    this.score = 0;
                    this.items = [];
                    this.playerX = window.innerWidth / 2;
                    this.loop();
                } else {
                    alert("Oyun hakkƒ±n bitti! √áarktan kazanabilirsin.");
                }
            },
            
            loop: function() {
                if(!this.active) return;
                const cvs = document.getElementById('gameCanvas');
                const ctx = cvs.getContext('2d');
                cvs.width = window.innerWidth; // Full width for container
                cvs.height = window.innerHeight - 160;

                // Background
                ctx.fillStyle = '#FFF9F9';
                ctx.fillRect(0,0, cvs.width, cvs.height);

                // Player (Basket/Hand)
                ctx.font = "50px Arial";
                ctx.textAlign = "center";
                ctx.fillText("üß∫", this.playerX, cvs.height - 30);

                // Spawner
                if(Math.random() < 0.03) {
                    const isGood = Math.random() > 0.3; // %70 iyi obje
                    // ƒ∞yi objeler: Hamur, Boya, G√∂kku≈üaƒüƒ± (Squishables temasƒ±)
                    // K√∂t√º objeler: Telefon, Tablet, TV (Screens Off temasƒ±)
                    const goodItems = ['üé®', 'üåà', '‚ú®', 'üßÅ'];
                    const badItems = ['üì±', 'üì∫', 'üîå'];
                    
                    const type = isGood 
                        ? goodItems[Math.floor(Math.random()*goodItems.length)] 
                        : badItems[Math.floor(Math.random()*badItems.length)];
                    
                    this.items.push({
                        x: Math.random() * (cvs.width - 40) + 20, 
                        y: -50, 
                        type: type,
                        isGood: isGood
                    });
                }

                // Update Items
                for(let i=0; i<this.items.length; i++) {
                    let item = this.items[i];
                    item.y += 6; // Speed
                    ctx.font = "40px Arial";
                    ctx.fillText(item.type, item.x, item.y);

                    // Collision
                    if(item.y > cvs.height - 60 && Math.abs(item.x - this.playerX) < 50) {
                        if(item.isGood) {
                            this.score += 10;
                        } else {
                            this.active = false;
                            alert(`Oyun Bitti! Ekrana yakalandƒ±n.\nSkorun: ${this.score}`);
                            app.state.points += this.score;
                            app.saveState();
                            document.getElementById('gameOverlay').style.display = 'flex';
                        }
                        this.items.splice(i, 1);
                    }
                }
                
                // Score UI
                ctx.fillStyle = "#555";
                ctx.font = "bold 24px Quicksand";
                ctx.fillText("Skor: " + this.score, 60, 40);

                requestAnimationFrame(this.loop.bind(this));
            }
        };

        // Touch/Mouse Controls
        const gameEl = document.getElementById('gameSection');
        gameEl.addEventListener('touchmove', (e) => {
            e.preventDefault();
            const rect = e.target.getBoundingClientRect();
            game.playerX = e.touches[0].clientX - rect.left;
        }, {passive: false});
        
        gameEl.addEventListener('mousemove', (e) => {
            const rect = e.target.getBoundingClientRect();
            game.playerX = e.clientX - rect.left;
        });

        // Start App
        app.init();

    </script>
</body>
</html>
